<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RainbowBrowserAI Dashboard - Chromiumoxide Edition</title>
    <link rel="stylesheet" href="/static/styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="logo">
                <i class="fas fa-rainbow"></i>
                <h1>RainbowBrowserAI <span class="edition">Chromiumoxide Edition</span></h1>
            </div>
            <div class="header-info">
                <div class="status-indicator" id="status">
                    <i class="fas fa-circle"></i>
                    <span>Connecting...</span>
                </div>
                <div class="tools-info">
                    <i class="fas fa-tools"></i>
                    <span>22 Tools Available</span>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Sidebar -->
            <aside class="sidebar">
                <nav class="nav-menu">
                    <a href="#" class="nav-item active" data-tab="command">
                        <i class="fas fa-terminal"></i>
                        <span>Tools Test</span>
                    </a>
                    <a href="#" class="nav-item" data-tab="browse">
                        <i class="fas fa-globe"></i>
                        <span>Browse</span>
                    </a>
                    <a href="#" class="nav-item" data-tab="workflow">
                        <i class="fas fa-project-diagram"></i>
                        <span>Workflows</span>
                    </a>
                    <a href="#" class="nav-item" data-tab="sessions">
                        <i class="fas fa-window-restore"></i>
                        <span>Sessions</span>
                    </a>
                    <a href="#" class="nav-item" data-tab="perception">
                        <i class="fas fa-brain"></i>
                        <span>Perception</span>
                    </a>
                    <a href="#" class="nav-item" data-tab="settings">
                        <i class="fas fa-cog"></i>
                        <span>Settings</span>
                    </a>
                </nav>
            </aside>

            <!-- Content Area -->
            <main class="content">
                <!-- Tools Test Tab -->
                <div class="tab-content active" id="command-tab">
                    <div class="content-header">
                        <h2><i class="fas fa-vial"></i> Browser Tools Testing Interface</h2>
                        <p class="header-desc">Test individual browser automation tools or run comprehensive tests</p>
                        <div class="quick-help">
                            <details>
                                <summary><i class="fas fa-question-circle"></i> Common Element Selectors Guide</summary>
                                <div class="help-content">
                                    <div class="help-grid">
                                        <div class="help-section">
                                            <h4>GitHub.com</h4>
                                            <ul>
                                                <li><code>input[name="q"]</code> - Search box</li>
                                                <li><code>.Header-link</code> - Header links</li>
                                                <li><code>.btn</code> - Buttons</li>
                                                <li><code>a</code> - Any link</li>
                                            </ul>
                                        </div>
                                        <div class="help-section">
                                            <h4>Common Selectors</h4>
                                            <ul>
                                                <li><code>h1, h2, h3</code> - Headings</li>
                                                <li><code>input</code> - Input fields</li>
                                                <li><code>button</code> - Buttons</li>
                                                <li><code>body</code> - Page body</li>
                                            </ul>
                                        </div>
                                        <div class="help-section">
                                            <h4>CSS Syntax</h4>
                                            <ul>
                                                <li><code>#id</code> - By ID</li>
                                                <li><code>.class</code> - By class</li>
                                                <li><code>[attr="value"]</code> - By attribute</li>
                                                <li><code>tag</code> - By tag name</li>
                                            </ul>
                                        </div>
                                    </div>
                                    <p><strong>ðŸ’¡ Tip:</strong> Navigate to a page first using the Browse tab, then test tools with elements that exist on that page!</p>
                                </div>
                            </details>
                        </div>
                    </div>

                    <!-- Quick Test Actions -->
                    <div class="browser-controls">
                        <h3>Quick Actions</h3>
                        <div class="tool-buttons">
                            <button class="btn btn-primary" onclick="quickTest('navigation')">
                                <i class="fas fa-compass"></i> Test Navigation
                            </button>
                            <button class="btn btn-primary" onclick="quickTest('interaction')">
                                <i class="fas fa-hand-pointer"></i> Test Interaction
                            </button>
                            <button class="btn btn-primary" onclick="quickTest('extraction')">
                                <i class="fas fa-database"></i> Test Extraction
                            </button>
                            <button class="btn btn-success" onclick="testAllTools()">
                                <i class="fas fa-check-double"></i> Test All Tools
                            </button>
                        </div>
                    </div>

                    <!-- Individual Tools Testing -->
                    <div class="tools-section">
                        <h3>Individual Tool Testing</h3>
                        
                        <!-- Navigation Tools -->
                        <div class="tool-category">
                            <h4><i class="fas fa-compass"></i> Navigation Tools (5)</h4>
                            <div class="tools-grid">
                                <div class="tool-card">
                                    <h5>Navigate to URL</h5>
                                    <div class="tool-inputs">
                                        <input type="text" id="nav-url" placeholder="https://example.com" value="https://example.com">
                                    </div>
                                    <button class="btn btn-secondary" onclick="executeNavigateTool()">Execute</button>
                                </div>
                                
                                <div class="tool-card">
                                    <h5>Scroll Page</h5>
                                    <div class="tool-inputs">
                                        <input type="number" id="scroll-x" placeholder="X" value="0">
                                        <input type="number" id="scroll-y" placeholder="Y" value="300">
                                    </div>
                                    <button class="btn btn-secondary" onclick="executeScrollTool()">Execute</button>
                                </div>
                                
                                <div class="tool-card">
                                    <h5>Browser Controls</h5>
                                    <div class="tool-buttons">
                                        <button class="btn btn-sm" onclick="executeTool('refresh', {})">Refresh</button>
                                        <button class="btn btn-sm" onclick="executeTool('go_back', {})">Back</button>
                                        <button class="btn btn-sm" onclick="executeTool('go_forward', {})">Forward</button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Interaction Tools -->
                        <div class="tool-category">
                            <h4><i class="fas fa-hand-pointer"></i> Interaction Tools (5)</h4>
                            <div class="tools-grid">
                                <div class="tool-card">
                                    <h5>Click Element</h5>
                                    <div class="tool-inputs">
                                        <input type="text" id="click-selector" placeholder="CSS Selector" value="a">
                                        <small class="helper-text">Examples: a, button, .btn, #submit, [data-action]</small>
                                    </div>
                                    <button class="btn btn-secondary" onclick="executeClickTool()">Execute</button>
                                </div>
                                
                                <div class="tool-card">
                                    <h5>Type Text</h5>
                                    <div class="tool-inputs">
                                        <input type="text" id="type-selector" placeholder="Input Selector" value="input">
                                        <small class="helper-text">Examples: input, textarea, [name='search'], #username</small>
                                        <input type="text" id="type-text" placeholder="Text" value="Hello World">
                                    </div>
                                    <button class="btn btn-secondary" onclick="executeTypeTool()">Execute</button>
                                </div>
                                
                                <div class="tool-card">
                                    <h5>Mouse Actions</h5>
                                    <div class="tool-inputs">
                                        <input type="text" id="hover-selector" placeholder="Selector" value="button">
                                    </div>
                                    <div class="tool-buttons">
                                        <button class="btn btn-sm" onclick="executeHoverTool()">Hover</button>
                                        <button class="btn btn-sm" onclick="executeFocusTool()">Focus</button>
                                    </div>
                                </div>
                                
                                <div class="tool-card">
                                    <h5>Select Option</h5>
                                    <div class="tool-inputs">
                                        <input type="text" id="select-selector" placeholder="Select Selector" value="select">
                                        <input type="text" id="select-value" placeholder="Option Value" value="test">
                                    </div>
                                    <button class="btn btn-secondary" onclick="executeSelectOptionTool()">Execute</button>
                                </div>
                            </div>
                        </div>

                        <!-- Extraction Tools -->
                        <div class="tool-category">
                            <h4><i class="fas fa-database"></i> Data Extraction Tools (5)</h4>
                            <div class="tools-grid">
                                <div class="tool-card">
                                    <h5>Extract Text</h5>
                                    <div class="tool-inputs">
                                        <input type="text" id="extract-text-selector" placeholder="Selector" value="h1">
                                    </div>
                                    <button class="btn btn-secondary" onclick="executeExtractTextTool()">Execute</button>
                                </div>
                                
                                <div class="tool-card">
                                    <h5>Extract Links</h5>
                                    <div class="tool-inputs">
                                        <input type="text" id="extract-links-selector" placeholder="Selector" value="a">
                                    </div>
                                    <button class="btn btn-secondary" onclick="executeExtractLinksTool()">Execute</button>
                                </div>
                                
                                <div class="tool-card">
                                    <h5>Extract Data</h5>
                                    <div class="tool-inputs">
                                        <input type="text" id="extract-data-selector" placeholder="Selector" value="img">
                                        <input type="text" id="extract-data-attributes" placeholder="Attributes" value="src,alt">
                                    </div>
                                    <button class="btn btn-secondary" onclick="executeExtractDataTool()">Execute</button>
                                </div>
                            </div>
                        </div>

                        <!-- Memory & Sync Tools -->
                        <div class="tool-category">
                            <h4><i class="fas fa-memory"></i> Memory & Sync Tools (7)</h4>
                            <div class="tools-grid">
                                <div class="tool-card">
                                    <h5>Screenshot</h5>
                                    <div class="tool-inputs">
                                        <label class="checkbox">
                                            <input type="checkbox" id="screenshot-full">
                                            <span>Full Page</span>
                                        </label>
                                    </div>
                                    <button class="btn btn-secondary" onclick="executeScreenshotTool()">Execute</button>
                                </div>
                                
                                <div class="tool-card">
                                    <h5>Wait for Element</h5>
                                    <div class="tool-inputs">
                                        <input type="text" id="wait-selector" placeholder="Selector" value="body">
                                        <input type="number" id="wait-timeout" placeholder="Timeout (ms)" value="5000">
                                    </div>
                                    <button class="btn btn-secondary" onclick="executeWaitForElementTool()">Execute</button>
                                </div>
                                
                                <div class="tool-card">
                                    <h5>Element Info</h5>
                                    <div class="tool-inputs">
                                        <input type="text" id="element-info-selector" placeholder="Selector" value="body">
                                    </div>
                                    <button class="btn btn-secondary" onclick="executeElementInfoTool()">Execute</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Test Results -->
                    <div class="command-output">
                        <h3>Test Results</h3>
                        <div id="command-result" class="result-container">
                            Ready for testing. Select a tool above or run comprehensive tests.
                        </div>
                    </div>
                </div>

                <!-- Browse Tab -->
                <div class="tab-content" id="browse-tab">
                    <div class="content-header">
                        <h2><i class="fas fa-globe"></i> Browse</h2>
                        <p class="header-desc">Navigate and interact with web pages</p>
                    </div>
                    <div class="browser-controls">
                        <div class="url-bar">
                            <input type="text" id="url-input" placeholder="Enter URL..." value="https://example.com">
                            <button id="navigate-btn" class="btn btn-primary">
                                <i class="fas fa-arrow-right"></i> Go
                            </button>
                        </div>
                        <div class="browser-toolbar">
                            <button class="btn btn-secondary" onclick="executeTool('go_back', {})">
                                <i class="fas fa-arrow-left"></i>
                            </button>
                            <button class="btn btn-secondary" onclick="executeTool('go_forward', {})">
                                <i class="fas fa-arrow-right"></i>
                            </button>
                            <button class="btn btn-secondary" onclick="executeTool('refresh', {})">
                                <i class="fas fa-sync"></i>
                            </button>
                            <button class="btn btn-info" onclick="takeScreenshot()">
                                <i class="fas fa-camera"></i> Screenshot
                            </button>
                        </div>
                        <div class="browser-preview">
                            <h3>Browser Preview</h3>
                            <div id="browser-preview-container" class="browser-frame">
                                Browser content will be displayed here via screenshots
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Workflow Tab -->
                <div class="tab-content" id="workflow-tab">
                    <div class="content-header">
                        <h2><i class="fas fa-project-diagram"></i> Workflow</h2>
                        <p class="header-desc">Create and execute automated workflows</p>
                    </div>
                    <div class="workflow-builder">
                        <div class="workflow-toolbar">
                            <button class="btn btn-primary" onclick="runWorkflow('demo')">
                                <i class="fas fa-play"></i> Run Demo Workflow
                            </button>
                            <button class="btn btn-success" onclick="runWorkflow('comprehensive')">
                                <i class="fas fa-check-double"></i> Comprehensive Test
                            </button>
                        </div>
                        <div class="workflow-code">
                            <h4>Sample Workflow:</h4>
                            <pre>
1. Navigate to https://example.com
2. Wait for page to load
3. Extract page title
4. Take screenshot
5. Extract all links
6. Generate report
                            </pre>
                        </div>
                        <div class="workflow-output">
                            <h3>Workflow Results</h3>
                            <div id="workflow-result" class="result-container"></div>
                        </div>
                    </div>
                </div>

                <!-- Sessions Tab -->
                <div class="tab-content" id="sessions-tab">
                    <div class="content-header">
                        <h2><i class="fas fa-window-restore"></i> Sessions</h2>
                        <p class="header-desc">Manage browser sessions</p>
                    </div>
                    <div class="sessions-manager">
                        <div class="session-controls">
                            <button class="btn btn-primary" onclick="createSession()">
                                <i class="fas fa-plus"></i> Create Session
                            </button>
                            <button class="btn btn-info" onclick="listSessions()">
                                <i class="fas fa-list"></i> List Sessions
                            </button>
                        </div>
                        <div class="sessions-info">
                            <div class="info-card">
                                <h4>Active Sessions</h4>
                                <p id="session-count">0</p>
                            </div>
                            <div class="info-card">
                                <h4>Current Session</h4>
                                <p id="current-session">None</p>
                            </div>
                        </div>
                        <div class="session-output">
                            <h3>Session Information</h3>
                            <div id="session-result" class="result-container"></div>
                        </div>
                    </div>
                </div>

                <!-- Perception Tab -->
                <div class="tab-content" id="perception-tab">
                    <div class="content-header">
                        <h2><i class="fas fa-brain"></i> Perception</h2>
                        <p class="header-desc">Advanced AI perception and page understanding with layered architecture</p>
                    </div>
                    
                    <div class="perception-panel">
                        <!-- NEW: Layered Perception Section -->
                        <div class="perception-section">
                            <h3><i class="fas fa-layer-group"></i> Layered Perception (å››å±‚æ„ŸçŸ¥)</h3>
                            <div class="perception-modes">
                                <button class="btn btn-lightning" onclick="perceiveWithMode('lightning')" title="<50ms - Basic page info">
                                    <i class="fas fa-bolt"></i> Lightning
                                </button>
                                <button class="btn btn-quick" onclick="perceiveWithMode('quick')" title="<200ms - Interactive elements">
                                    <i class="fas fa-tachometer-alt"></i> Quick
                                </button>
                                <button class="btn btn-standard" onclick="perceiveWithMode('standard')" title="<1000ms - Semantic analysis">
                                    <i class="fas fa-brain"></i> Standard
                                </button>
                                <button class="btn btn-deep" onclick="perceiveWithMode('deep')" title="<5000ms - Full analysis">
                                    <i class="fas fa-microscope"></i> Deep
                                </button>
                                <button class="btn btn-adaptive" onclick="perceiveWithMode('adaptive')" title="Auto-select based on complexity">
                                    <i class="fas fa-magic"></i> Adaptive
                                </button>
                            </div>
                            <div id="layered-perception-result" class="result-container"></div>
                        </div>

                        <!-- NEW: Quick Scan Section -->
                        <div class="perception-section">
                            <h3><i class="fas fa-radar"></i> Quick Page Scan</h3>
                            <div class="perception-controls">
                                <button class="btn btn-info" onclick="quickScan()">
                                    <i class="fas fa-search-plus"></i> Quick Scan
                                </button>
                                <button class="btn btn-warning" onclick="deepAnalysis()">
                                    <i class="fas fa-microscope"></i> Deep Analysis
                                </button>
                            </div>
                            <div id="quick-scan-result" class="result-container"></div>
                        </div>

                        <!-- NEW: Smart Element Search Section -->
                        <div class="perception-section">
                            <h3><i class="fas fa-search-location"></i> Smart Element Search</h3>
                            <div class="form-group">
                                <label>Search Query</label>
                                <input type="text" id="smart-search-query" 
                                       placeholder="e.g., 'button with text Submit', 'red warning message', 'main navigation menu'"
                                       class="form-control">
                                <small>Uses AI to find elements by description, not just CSS selectors</small>
                            </div>
                            <div class="form-group">
                                <label>Max Results</label>
                                <input type="number" id="smart-search-max" value="5" min="1" max="20" class="form-control">
                            </div>
                            <div class="perception-controls">
                                <button class="btn btn-success" onclick="smartElementSearch()">
                                    <i class="fas fa-search"></i> Smart Search
                                </button>
                            </div>
                            <div id="smart-search-result" class="result-container"></div>
                        </div>

                        <!-- Page Analysis Section -->
                        <div class="perception-section">
                            <h3><i class="fas fa-search"></i> Page Analysis</h3>
                            <div class="perception-controls">
                                <button class="btn btn-primary" onclick="analyzePage()">
                                    <i class="fas fa-eye"></i> Analyze Current Page
                                </button>
                                <button class="btn btn-info" onclick="classifyPage()">
                                    <i class="fas fa-tag"></i> Classify Page Type
                                </button>
                            </div>
                            <div id="analysis-result" class="result-container"></div>
                        </div>

                        <!-- Element Detection Section -->
                        <div class="perception-section">
                            <h3><i class="fas fa-crosshairs"></i> Smart Element Detection</h3>
                            <div class="form-group">
                                <label>Element Description (Natural Language)</label>
                                <input type="text" id="element-description" 
                                       placeholder="e.g., 'search button', 'login form', 'submit button'"
                                       class="form-control">
                            </div>
                            <div class="perception-controls">
                                <button class="btn btn-success" onclick="findElement()">
                                    <i class="fas fa-crosshairs"></i> Find Element
                                </button>
                                <button class="btn btn-warning" onclick="highlightElement()">
                                    <i class="fas fa-highlighter"></i> Highlight Found Element
                                </button>
                            </div>
                            <div id="element-result" class="result-container"></div>
                        </div>

                        <!-- Intelligent Commands Section -->
                        <div class="perception-section">
                            <h3><i class="fas fa-magic"></i> Intelligent Commands</h3>
                            <div class="form-group">
                                <label>Command (Natural Language)</label>
                                <input type="text" id="intelligent-command" 
                                       placeholder="e.g., 'click the login button', 'fill the search box with test'"
                                       class="form-control">
                            </div>
                            <div class="perception-controls">
                                <button class="btn btn-primary" onclick="executeIntelligentCommand()">
                                    <i class="fas fa-bolt"></i> Execute Command
                                </button>
                            </div>
                            <div id="command-result" class="result-container"></div>
                        </div>

                        <!-- Form Analysis Section -->
                        <div class="perception-section">
                            <h3><i class="fas fa-wpforms"></i> Smart Form Analysis</h3>
                            <div class="form-group">
                                <label>Form Selector (Optional)</label>
                                <input type="text" id="form-selector" 
                                       placeholder="Leave empty to analyze first form"
                                       class="form-control">
                            </div>
                            <div class="perception-controls">
                                <button class="btn btn-info" onclick="analyzeForm()">
                                    <i class="fas fa-search"></i> Analyze Form
                                </button>
                                <button class="btn btn-success" onclick="autoFillForm()">
                                    <i class="fas fa-magic"></i> Auto-Fill Form
                                </button>
                            </div>
                            <div id="form-result" class="result-container"></div>
                        </div>

                        <!-- Perception Statistics -->
                        <div class="perception-section">
                            <h3><i class="fas fa-chart-bar"></i> Perception Statistics</h3>
                            <div class="stats-grid">
                                <div class="stat-card">
                                    <div class="stat-value" id="elements-found">0</div>
                                    <div class="stat-label">Elements Found</div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-value" id="commands-executed">0</div>
                                    <div class="stat-label">Commands Executed</div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-value" id="forms-analyzed">0</div>
                                    <div class="stat-label">Forms Analyzed</div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-value" id="pages-analyzed">0</div>
                                    <div class="stat-label">Pages Analyzed</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Settings Tab -->
                <div class="tab-content" id="settings-tab">
                    <div class="content-header">
                        <h2><i class="fas fa-cog"></i> Settings</h2>
                        <p class="header-desc">Configure browser automation settings</p>
                    </div>
                    <div class="settings-panel">
                        <div class="settings-section">
                            <h3>Browser Settings</h3>
                            <div class="settings-form">
                                <div class="form-group">
                                    <label>API Endpoint</label>
                                    <input type="text" id="api-endpoint" value="http://localhost:3002">
                                </div>
                                <div class="form-group">
                                    <label>Default Timeout (ms)</label>
                                    <input type="number" id="timeout" value="30000">
                                </div>
                                <label class="checkbox">
                                    <input type="checkbox" id="headless-mode" checked>
                                    <span>Headless Mode</span>
                                </label>
                            </div>
                        </div>
                        <div class="settings-actions">
                            <button class="btn btn-primary" onclick="saveSettings()">
                                <i class="fas fa-save"></i> Save Settings
                            </button>
                            <button class="btn btn-secondary" onclick="loadSettings()">
                                <i class="fas fa-sync"></i> Load Settings
                            </button>
                        </div>
                    </div>
                </div>
            </main>
        </div>

        <!-- Notifications Container -->
        <div class="notifications" id="notifications"></div>
    </div>

    <script src="/static/app.js"></script>
</body>
</html>